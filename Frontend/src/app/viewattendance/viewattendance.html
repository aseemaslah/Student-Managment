<div class="d-flex">

  <!-- Sidebar -->
<app-studentsidebar></app-studentsidebar>

  <!-- Main -->
  <div class="flex-grow-1 p-4 bg-light">

    <div class="top-bar">
      <div class="title">
        <h3>My Attendance</h3>
        <p>Day by day record</p>
      </div>
    </div>

    <!-- Loading -->
    <div *ngIf="loading" class="text-center p-4">
      <div class="spinner-border" role="status"></div>
      <p class="mt-2">Loading attendance...</p>
    </div>

    <!-- Error -->
    <div *ngIf="error" class="alert alert-danger">{{error}}</div>

    <!-- Content -->
    <div *ngIf="!loading && !error">
      <!-- Summary -->
      <div class="row g-4 mt-3">
        <div class="col-md-4">
          <div class="card stat-card">
            <h6>Overall</h6>
            <h2>{{getAttendanceStats().percentage}}%</h2>
          </div>
        </div>

        <div class="col-md-4">
          <div class="card stat-card">
            <h6>Present</h6>
            <h2>{{getAttendanceStats().present}}</h2>
          </div>
        </div>

        <div class="col-md-4">
          <div class="card stat-card">
            <h6>Absent</h6>
            <h2>{{getAttendanceStats().absent}}</h2>
          </div>
        </div>
      </div>

      <!-- Attendance Table -->
      <div class="card p-4 mt-4 border-0 rounded-4 shadow-sm">
        <table class="table table-hover align-middle" *ngIf="attendance.length > 0">
          <thead>
            <tr>
              <th>Date</th>
              <th>Teacher</th>
              <th>Status</th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let record of attendance">
              <td>{{record.date | date:'dd MMM yyyy'}}</td>
              <td>{{record.teacherId?.username || 'N/A'}}</td>
              <td>
                <span class="badge" [class]="record.status === 'Present' ? 'bg-success' : 'bg-danger'">
                  {{record.status}}
                </span>
              </td>
            </tr>
          </tbody>
        </table>
        
        <div *ngIf="attendance.length === 0" class="text-center p-4">
          <p class="text-muted">No attendance records found</p>
        </div>
      </div>
    </div>

  </div>

</div>