<div class="d-flex">

  <!-- Sidebar -->
  <app-teachersidebar></app-teachersidebar>

  <!-- Main -->
  <div class="flex-grow-1 p-4 bg-light">

    <!-- Header -->
    <div class="top-bar">
      <div class="title">
        <h3>My Students</h3>
        <p>Students in your classes</p>
      </div>
    </div>

    <!-- Student Table Card -->
    <div class="card p-4 border-0 rounded-4 shadow-sm">

      <!-- Loading -->
      @if (loading) {
        <div class="text-center p-4">
          <div class="spinner-border" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <p class="mt-2">Loading students...</p>
        </div>
      }

      <!-- Error -->
      @if (error) {
        <div class="alert alert-danger">{{ error }}</div>
      }

      <!-- Table -->
      @if (!loading && !error) {

        <div class="table-responsive">
          <table class="table table-hover align-middle" style="table-layout: fixed;">
            <thead>
              <tr>
                <th style="width: 90px;">Roll No</th>
                <th style="width: 180px;">Name</th>
                <th style="width: 120px;">Class</th>
                <th style="width: 120px;">Division</th>
                <th style="width: 160px;">Academic Year</th>
                <th style="width: 100px;">Status</th>
                <th
                  class="text-end"
                  style="width: 160px; min-width: 160px;"
                >
                  Actions
                </th>
              </tr>
            </thead>

            <tbody>
              @for (student of students; track student._id) {
                <tr>
                  <td>{{ student.rollNo }}</td>
                  <td>{{ student.userId?.username }}</td>
                  <td>{{ student.classId?.Class }}</td>
                  <td>{{ student.classId?.Division }}</td>
                  <td>{{ student.classId?.AcademicYear }}</td>
                  <td>
                    <span class="badge bg-success">Active</span>
                  </td>

                  <!-- ðŸ”¥ Edit / Delete Buttons -->
                  <td class="text-end" style="white-space: nowrap;">
                    <button
                      class="btn btn-sm btn-outline-primary me-2"
                      (click)="onEditStudent(student)"
                    >
                      Edit
                    </button>

                    <button
                      class="btn btn-sm btn-outline-danger"
                      (click)="onDeleteStudent(student._id)"
                    >
                      Delete
                    </button>
                  </td>
                </tr>
              }

              @if (students.length === 0) {
                <tr>
                  <td colspan="7" class="text-center py-4">
                    No students found
                  </td>
                </tr>
              }
            </tbody>
          </table>
        </div>

      }

    </div>
  </div>
</div>
